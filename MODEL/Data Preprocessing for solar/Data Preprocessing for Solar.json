{"main":"muzgua5n3336krs4","models":{"muzgua5n3336krs4":{"variables":{},"variableRef":[],"innerModels":{},"inData":[],"outData":[],"type":"data","param":{},"functions":[{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["txtpebt66tma9tzp"],"models":["te6s58ra6ana42nq"],"images":[]},"outputs":{"df":"tg3ueaee588qswng"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\nimport pandas as pd\n\ndf = inputs[0]\ndf['_datetime'] = pd.to_datetime(df['datetime'])\ndf['month'] = df['_datetime'].apply(lambda x: x.month)\ndf['day'] = df['_datetime'].apply(lambda x: x.day)\ndf['hour'] = df['_datetime'].apply(lambda x: x.hour)\ndf = df.drop(columns=['_datetime'])"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"df":{"type":"table"}},"fid":"fc9hrdpngzxk4rjp","label":"Python Script: 월,일,시간 추가","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.extraction$scale","name":"brightics.function.extraction$scale","param":{"scaler":"RobustScaler","input_cols":["temperature","windspeed","winddirection","humidity"],"suffix":"_robust"},"meta":{"table":{"type":"table","desc":"Data in a table","optional":false},"out_table":{"type":"table","desc":""},"model":{"type":"model","desc":"Normalized data"}},"context":"python","version":"3.6","inputs":{"table":"tr4dvnesjbgtbetj"},"outputs":{"out_table":"txtpebt66tma9tzp","model":"te6s58ra6ana42nq"},"fid":"f64cdk5zfyw9y5vv","label":"Normalization","persist":true,"skip":false},{"persist-mode":"auto","context":"python","func":"merge","name":"brightics.function.transform$join","version":"3.6","inputs":{"left_table":"t2b6mae6jqsby6ty","right_table":"tztz4jjkjchu746e"},"outputs":{"table":"t39pg4wshpyufaj8"},"meta":{"left_table":{"type":"table"},"right_table":{"type":"table"},"table":{"type":"table"}},"param":{"left_on":["datetime"],"right_on":["datetime"],"how":"inner","sort":"false"},"fid":"fcs6d3wsm4xs63tr","label":"Join","persist":true,"skip":false},{"persist-mode":"auto","context":"python","func":"merge","name":"brightics.function.transform$join","version":"3.6","inputs":{"left_table":"t39pg4wshpyufaj8","right_table":"trvzd329eqgjc74y"},"outputs":{"table":"tdryu476ayej3fte"},"meta":{"left_table":{"type":"table"},"right_table":{"type":"table"},"table":{"type":"table"}},"param":{"left_on":["datetime"],"right_on":["datetime"],"how":"inner","sort":"false"},"fid":"fzae3n3rmn87r29g","label":"Join","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["tdryu476ayej3fte"],"models":[],"images":[]},"outputs":{"df":"tymfm365zpxjrnnf"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\nimport pandas as pd\ndf = inputs[0]\n\ndf['datetime'] = pd.to_datetime(df['datetime']).astype(str)"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"df":{"type":"table"}},"fid":"f56gsu9ne5xw52ju","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.io$load13889","name":"brightics.function.io$load","param":{"partial_path":["/brightics@samsung.com/upload/solar_weather_actual_0810.csv"]},"meta":{"table":{"type":"table"}},"context":"python","version":"3.6","outputs":{"table":"tmy2txu54cvbv8tz"},"fid":"f3vv57jystaf96me","label":"\b관측(온도, 습도, 풍속, 풍향)","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_train","name":"brightics.function.regression$xgb_regression_train","param":{"importance_type":"gain","feature_cols":["temperature_robust","windspeed_robust","humidity_robust","winddirection_cos","winddirection_sin","hour_cos","hour_sin","day_cos","day_sin","month_cos","month_sin"],"label_col":"일조"},"meta":{"table":{"type":"table"},"model":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g"},"outputs":{"model":"t67s9zutxcr5tf8u"},"fid":"fwf3axgnxb2upr3x","label":"XGB Regression Train :일조","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_train","name":"brightics.function.regression$xgb_regression_train","param":{"importance_type":"gain","feature_cols":["humidity_robust","windspeed_robust","temperature_robust","winddirection_cos","winddirection_sin","hour_cos","hour_sin","day_cos","day_sin","month_cos","month_sin"],"label_col":"일사"},"meta":{"table":{"type":"table"},"model":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g"},"outputs":{"model":"tfhn56nd8r7d3vwc"},"fid":"fgj9t4exsww5wcsn","label":"XGB Regression Train : 일사","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_train","name":"brightics.function.regression$xgb_regression_train","param":{"importance_type":"weight","feature_cols":["winddirection_cos","winddirection_sin","hour_cos","hour_sin","day_cos","day_sin","month_cos","month_sin","humidity_robust","windspeed_robust","temperature_robust"],"label_col":"전운량","objectibe":"reg:linear"},"meta":{"table":{"type":"table"},"model":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g"},"outputs":{"model":"tpxrnk8xssqkedwe"},"fid":"fsxwcdhdsnmsesen","label":"XGB Regression Train : 전운량","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_predict","name":"brightics.function.regression$xgb_regression_predict","param":{},"meta":{"table":{"type":"table"},"model":{"type":"model"},"out_table":{"type":"table"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g","model":"t67s9zutxcr5tf8u"},"outputs":{"out_table":"t2v8a6cw5cwbvkuh"},"fid":"fpbszqs6q6g84mdg","label":"XGB Regression Predict","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_predict","name":"brightics.function.regression$xgb_regression_predict","param":{},"meta":{"table":{"type":"table"},"model":{"type":"model"},"out_table":{"type":"table"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g","model":"tfhn56nd8r7d3vwc"},"outputs":{"out_table":"trybvj6dx6gk6dwc"},"fid":"fuec8z2g6vqb2t9y","label":"XGB Regression Predict","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.regression$xgb_regression_predict","name":"brightics.function.regression$xgb_regression_predict","param":{},"meta":{"table":{"type":"table"},"model":{"type":"model"},"out_table":{"type":"table"}},"context":"python","version":"3.6","inputs":{"table":"tkdk48d77rmqfk9g","model":"tpxrnk8xssqkedwe"},"outputs":{"out_table":"ttnjmwxe3zmzedte"},"fid":"fmrghbwaybctntuq","label":"XGB Regression Predict","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.evaluation$evaluate_regression","name":"brightics.function.evaluation$evaluate_regression","param":{"label_col":"일조","prediction_col":"prediction"},"meta":{"table":{"type":"table"},"result":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"t2v8a6cw5cwbvkuh"},"outputs":{"result":"thxc8b2c32rkz2sv"},"fid":"fxadcd3vny2r5gz4","label":"Evaluate Regression","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["t2v8a6cw5cwbvkuh"],"models":[],"images":[]},"outputs":{"df":"tt63dunw398zpd6j"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\n\nimport pandas as pd\ndf = inputs[0]\n\ndf['prediction'] = df['prediction'].apply(lambda x: x if x > 0 else 0)\ndf['prediction'] = df['prediction'].apply(lambda x: x if x < 1 else 1)"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"df":{"type":"table"}},"fid":"f9cn25eg9zgjmtdc","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.evaluation$evaluate_regression","name":"brightics.function.evaluation$evaluate_regression","param":{"label_col":"일사","prediction_col":"prediction"},"meta":{"table":{"type":"table"},"result":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"trybvj6dx6gk6dwc"},"outputs":{"result":"tv9y27cns7p9ne7w"},"fid":"fdqrvhgsfqzqubdp","label":"Evaluate Regression","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["trybvj6dx6gk6dwc"],"models":[],"images":[]},"outputs":{"df":"tgvdek2rfjkqqjnc"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\n\nimport pandas as pd\ndf = inputs[0]\n\ndf['prediction'] = df['prediction'].apply(lambda x: x if x > 0 else 0)"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"df":{"type":"table"}},"fid":"f2g2nmpq7tf66u7t","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.evaluation$evaluate_regression","name":"brightics.function.evaluation$evaluate_regression","param":{"label_col":"전운량","prediction_col":"prediction"},"meta":{"table":{"type":"table"},"result":{"type":"model"}},"context":"python","version":"3.6","inputs":{"table":"ttnjmwxe3zmzedte"},"outputs":{"result":"tfjwhp8nyam39nq3"},"fid":"fezuakq6ru4rv6h2","label":"Evaluate Regression","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["ttnjmwxe3zmzedte"],"models":[],"images":[]},"outputs":{"df":"t2bdaumgpt4bfx9x"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\n\nimport pandas as pd\ndf = inputs[0]\n\ndf['prediction'] = df['prediction'].apply(lambda x: x if x > 0 else 0)\ndf['prediction'] = df['prediction'].apply(lambda x: x if x < 10 else 10)\ndf['prediction'] = df['prediction'].apply(lambda x: int(x+0.5))"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"df":{"type":"table"}},"fid":"ftnwwj6ttqpjd39z","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"selectColumnPython","name":"brightics.function.transform$select_column","context":"python","version":"3.6","param":{"input_cols":["datetime","temperature","windspeed","winddirection","humidity","prediction"],"output_cols":["datetime","temperature","windspeed","winddirection","humidity","일조"],"output_types":["string","double","double","double","double","string"]},"inputs":{"table":"tt63dunw398zpd6j"},"outputs":{"out_table":"t2b6mae6jqsby6ty"},"meta":{"table":{"type":"table"},"out_table":{"type":"table"}},"fid":"fd2yahw2ysvr88p3","label":"Select Column","persist":true,"skip":false},{"persist-mode":"auto","func":"selectColumnPython","name":"brightics.function.transform$select_column","context":"python","version":"3.6","param":{"input_cols":["datetime","prediction"],"output_cols":["datetime","일사"],"output_types":["string","string"]},"inputs":{"table":"tgvdek2rfjkqqjnc"},"outputs":{"out_table":"tztz4jjkjchu746e"},"meta":{"table":{"type":"table"},"out_table":{"type":"table"}},"fid":"ffdfyverdhx46qn5","label":"Select Column","persist":true,"skip":false},{"persist-mode":"auto","func":"selectColumnPython","name":"brightics.function.transform$select_column","context":"python","version":"3.6","param":{"input_cols":["datetime","prediction"],"output_cols":["datetime","전운량"],"output_types":["string","string"]},"inputs":{"table":"t2bdaumgpt4bfx9x"},"outputs":{"out_table":"trvzd329eqgjc74y"},"meta":{"table":{"type":"table"},"out_table":{"type":"table"}},"fid":"fjwu2q5x54k5exsk","label":"Select Column","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["tg3ueaee588qswng"],"models":[],"images":[]},"outputs":{"X_2":"tkdk48d77rmqfk9g","plt":"tj8qfz9xtp7zksag"},"param":{"script":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom datetime import date\nfrom sklearn.preprocessing import FunctionTransformer\n\ndef sin_transformer(period):\n    return FunctionTransformer(lambda x: np.sin(x / period * 2 * np.pi))\n  \ndef cos_transformer(period):\n    return FunctionTransformer(lambda x: np.cos(x / period * 2 * np.pi))\n\nX_2 = inputs[0]\n\nX_2[\"month_sin\"] = sin_transformer(12).fit_transform(X_2[[\"month\"]])\nX_2[\"month_cos\"] = cos_transformer(12).fit_transform(X_2[[\"month\"]])\n\nX_2[\"day_sin\"] = sin_transformer(30).fit_transform(X_2[[\"day\"]])\nX_2[\"day_cos\"] = cos_transformer(30).fit_transform(X_2[[\"day\"]])\n\nX_2[\"hour_sin\"] = sin_transformer(24).fit_transform(X_2[[\"hour\"]])\nX_2[\"hour_cos\"] = cos_transformer(24).fit_transform(X_2[[\"hour\"]])\n\nX_2[\"winddirection_sin\"] = sin_transformer(360).fit_transform(X_2[[\"winddirection\"]])\nX_2[\"winddirection_cos\"] = cos_transformer(360).fit_transform(X_2[[\"winddirection\"]])\n\nfig, ax = plt.subplots(3, 1, sharex=True, figsize=(300,8))\nX_2[[\"month_sin\", \"month_cos\"]].plot(ax=ax[0])\nX_2[[\"day_sin\", \"day_cos\"]].plot(ax=ax[1])\nX_2[[\"winddirection_sin\", \"winddirection_cos\"]].plot(ax=ax[2])\nplt.suptitle(\"Cyclical encoding with sine/cosine transformation\")\nplt.show();"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"X_2":{"type":"table"},"plt":{"type":"image"}},"fid":"fgztnemmde3gn4zz","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.io$load13889","name":"brightics.function.io$load","param":{"partial_path":["/brightics@samsung.com/upload/solar_forecast_final.csv"]},"meta":{"table":{"type":"table"}},"context":"python","version":"3.6","outputs":{"table":"tz57y5hw42a3ky6e"},"fid":"fcbf4ma6uv9mperc","label":"Load : 예보데이터","persist":true,"skip":false},{"persist-mode":"auto","func":"pythonScript","name":"PythonScript","inputs":{"inputs":["tmy2txu54cvbv8tz","tz57y5hw42a3ky6e"],"models":[],"images":[]},"outputs":{"data":"t6rdy7uws482xc2d"},"param":{"script":"#\n#   NOTE : Enter \"Out Table Alias\"\n#   ex)\n#       inputDataframe = inputs[0]\n#       result = inputDataframe\n#\nimport pandas as pd\nimport numpy as np\n\nactual = inputs[0]\nforecast = inputs[1]\n\nactual[\"datetime\"] = pd.to_datetime(actual[\"datetime\"])\nforecast[\"datetime\"] = pd.to_datetime(forecast[\"datetime\"])\n\nactual = actual[[\"datetime\",\"일조\",\"일사\",\"전운량\"]]\n\ndata = pd.merge(forecast,actual,how = \"left\", on = \"datetime\")\ndata[\"datetime\"] = data[\"datetime\"].dt.strftime(\"%Y-%m-%d %H:%M:%S\")"},"version":"3.6","context":"python","meta":{"inputs":{"type":"table","range":{"min":1,"max":10}},"models":{"type":"model","range":{"min":1,"max":10}},"images":{"type":"image","range":{"min":1,"max":10}},"data":{"type":"table"}},"fid":"fu84mhnws6e53mas","label":"Python Script","persist":true,"skip":false},{"persist-mode":"auto","func":"brightics.function.transform$delete_missing_data","name":"brightics.function.transform$delete_missing_data","param":{"row_or_column":"index","input_cols":["datetime","forecast_time","forecast","temperature","humidity","windspeed","winddirection","일조","일사","전운량"]},"meta":{"out_table":{"type":"table","desc":"Output table for Delete Missing Value. "},"table":{"type":"table","desc":"Data in a Table. ","optional":false}},"context":"python","version":"3.6","inputs":{"table":"t6rdy7uws482xc2d"},"outputs":{"out_table":"tr4dvnesjbgtbetj"},"fid":"fq52yzsxs7w92mre","label":"Delete Missing Data","persist":true,"skip":false}],"links":[{"kid":"kzvhnznsynqka5vz","sourceFid":"f64cdk5zfyw9y5vv","targetFid":"fc9hrdpngzxk4rjp"},{"kid":"kqzh2wchxmfxdgue","sourceFid":"fcs6d3wsm4xs63tr","targetFid":"fzae3n3rmn87r29g"},{"kid":"khc42fpkdjm9jcjs","sourceFid":"fzae3n3rmn87r29g","targetFid":"f56gsu9ne5xw52ju"},{"kid":"ka9ys2bhh6gmh8ry","sourceFid":"fwf3axgnxb2upr3x","targetFid":"fpbszqs6q6g84mdg"},{"kid":"kqzr8g4y6hbgvqn4","sourceFid":"fpbszqs6q6g84mdg","targetFid":"fxadcd3vny2r5gz4"},{"kid":"ke7gbebk2qp7gg7r","sourceFid":"fpbszqs6q6g84mdg","targetFid":"f9cn25eg9zgjmtdc"},{"kid":"kbf5dkwur3xkqczg","sourceFid":"fgj9t4exsww5wcsn","targetFid":"fuec8z2g6vqb2t9y"},{"kid":"kv5mfmp22c35g4a4","sourceFid":"fuec8z2g6vqb2t9y","targetFid":"fdqrvhgsfqzqubdp"},{"kid":"kmwsaw7p77zyrh25","sourceFid":"fuec8z2g6vqb2t9y","targetFid":"f2g2nmpq7tf66u7t"},{"kid":"kvu53fwkdkueae4m","sourceFid":"fsxwcdhdsnmsesen","targetFid":"fmrghbwaybctntuq"},{"kid":"kqh3s6e3yjdjn7du","sourceFid":"fmrghbwaybctntuq","targetFid":"fezuakq6ru4rv6h2"},{"kid":"kfh6zs4fvweyyzgr","sourceFid":"fmrghbwaybctntuq","targetFid":"ftnwwj6ttqpjd39z"},{"kid":"knfwtx7jamw2n284","sourceFid":"f9cn25eg9zgjmtdc","targetFid":"fd2yahw2ysvr88p3"},{"kid":"kb52ww2gg38skqyn","sourceFid":"f2g2nmpq7tf66u7t","targetFid":"ffdfyverdhx46qn5"},{"kid":"k5c82bgtmawncxu3","sourceFid":"ftnwwj6ttqpjd39z","targetFid":"fjwu2q5x54k5exsk"},{"kid":"kcw554vts7v5y5pg","sourceFid":"fgztnemmde3gn4zz","targetFid":"fpbszqs6q6g84mdg"},{"kid":"ks6xku5nn9hat5xm","sourceFid":"fgztnemmde3gn4zz","targetFid":"fuec8z2g6vqb2t9y"},{"kid":"kg59r6s9rbp3mhc6","sourceFid":"fgztnemmde3gn4zz","targetFid":"fmrghbwaybctntuq"},{"kid":"ka7bv6ywesee3yec","sourceFid":"fgztnemmde3gn4zz","targetFid":"fgj9t4exsww5wcsn"},{"kid":"kru5p6xea7zka38m","sourceFid":"ffdfyverdhx46qn5","targetFid":"fcs6d3wsm4xs63tr"},{"kid":"kp5pwp2q2r9jw2r9","sourceFid":"fd2yahw2ysvr88p3","targetFid":"fcs6d3wsm4xs63tr"},{"kid":"k4c3byrdxdhhdn4s","sourceFid":"fjwu2q5x54k5exsk","targetFid":"fzae3n3rmn87r29g"},{"kid":"kngffasyv286dhed","sourceFid":"fc9hrdpngzxk4rjp","targetFid":"fgztnemmde3gn4zz"},{"kid":"kkvrjxmstkuus5k7","sourceFid":"f3vv57jystaf96me","targetFid":"fu84mhnws6e53mas"},{"kid":"k9c3ury7rn7gq5wz","sourceFid":"fcbf4ma6uv9mperc","targetFid":"fu84mhnws6e53mas"},{"kid":"k4gmgxef78rdxcgt","sourceFid":"fu84mhnws6e53mas","targetFid":"fq52yzsxs7w92mre"},{"kid":"k67nx6tfxsz366yc","sourceFid":"fq52yzsxs7w92mre","targetFid":"f64cdk5zfyw9y5vv"},{"kid":"kgu9ncestm7vhk2d","sourceFid":"fgztnemmde3gn4zz","targetFid":"fwf3axgnxb2upr3x"},{"kid":"kzfbhha9w87v8xr2","sourceFid":"fgztnemmde3gn4zz","targetFid":"fsxwcdhdsnmsesen"}],"mid":"muzgua5n3336krs4","title":"Data Preprocessing for Solar","persist-mode":"auto","diagram":{"PAPER_MARGIN_TOP":20,"PAPER_MARGIN_LEFT":20,"FIGURE_WIDTH":195,"FIGURE_HEIGHT":60,"GAP_WIDTH":55,"GAP_HEIGHT":40},"entries":["f3vv57jystaf96me","fcbf4ma6uv9mperc"],"optModels":{}}},"version":"3.6"}